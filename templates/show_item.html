{% extends "layout.html" %}

{% block title %}{{ item.title }}{% endblock %}

{% block content %}

<h2>{{ item.title }}</h2>
{% if session.user_id == item.user_id %}
<p>
  <a href="/edit_item/{{ item.id }}">Muokkaa</a>
  <a href="/remove_item/{{ item.id }}">Poista</a>
  <a href="/images/{{ item.id }}">Kuvat</a>
</p>
{% endif %}
{% for image in images %}
<img src="/image/{{ image.id }}" alt="Reseptin kuva"/>
{% endfor %}

<p>
  <h3>Ainekset:</h3>
  {{ item.ingredients | show_lines }}
</p>
<p>
  <h3>Ohjeet:</h3>
  {{ item.instructions | show_lines }}
</p>
<ul>
  <li>Reseptin lis√§nnyt: <a href="/user/{{ item.user_id}}">{{ item.username }}</a></li>
{% if classes %}
  {% for class in classes %}
  <li>{{ class.title }}: {{ class.value }}</li>
  {% endfor %}
</ul>
{% endif %}
<h3>Arvostelut</h3>
{% if average %}
<p>
  Arvosana: {{ average }} / 5
  {% else %}
  Arvosana: 0 / 5
</p>
{% endif %}
<p>
  <ul>
    {% for review in reviews %}
    <li>{{ review.rating }}/5, {{ review.comment }}, <a href="/user/{{ review.user_id }}">{{ review.username }}</a></li>
    {% endfor %}
  </ul>
</p>
{% if session.user_id %}
<h3>Arvostele resepti</h3>
<form action="/create_review" method="post">
  <input type="hidden" name="item_id" value="{{ item.id }}">
  <p>
    <label for="review_rating">Arvio:</label>
    <input type="text" name="review_rating" id="review_rating" size="8" pattern="[1-5]" required /> /5
  </p>
  <p>
    <label for="review_comment">Kommentti:</label>
    <input type="text" name="review_comment" id="review_comment" size="40" />
  </p>
  <p>
    <input type="hidden" name="csrf_token" value="{{ session.csrf_token }}" />
    <input type="submit" value="Arvostele" />
  </p>
</form>
{% endif %}

{% endblock %}
